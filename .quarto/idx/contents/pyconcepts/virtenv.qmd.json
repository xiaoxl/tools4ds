{"title":"Python Virtual Environment","markdown":{"yaml":{"format":{"html":{"code-line-numbers":false,"code-block-border-left":false}}},"headingText":"Python Virtual Environment","containsRefs":false,"markdown":"\n\n\n\n\n\n## Package management\nThere are two most popular package management tools for Python, `pip` and `conda`. \n\n- [`pip`](https://pip.pypa.io/) is the official package management tool for Python. \n- [`conda`](https://github.com/conda/conda) was originally developed by Anaconda Inc., and later became open-sourced. \n\nIn this course, we mainly focus on `conda` since it is designed towards Data Science.\n\n1. Install packages. You may specify the particular version number.\n\n```{.bash}\nconda install <pkg name>\nconda install <pkg name>=<version number>\n```\n\n2. List all installed packages, or list several specific installed packages:\n\n```{.bash}\nconda list\nconda list <pkg names>\n```\n\n3. Update packages.\n\n```{.bash}\nconda updata <pkg name>\n```\n\n4. Remove packages.\n\n```{.bash}\nconda remove <pkg name>\n```\n5. If the packages you want is in `PyPI` but not in `conda` channels, you may use `pip` to install that package.\n\n```{.bash}\npip install <pkg name>\n```\nNote that if the package is in both `conda` channels and `PyPI`, it is recommended not to mix `pip` and `conda`. If you start from `conda`, just stick to `conda`. Only use `pip` when you have to.\n\n\n\n::: {.callout-note collapse=\"true\"}\n## `PyPI` and `conda-forge`\n\nThe package managemers will download packages from online repository to install in your environment. By default, `pip` and `conda` use two different repositories. \n\n- [`PyPI`](https://pypi.org/): `PyPI` stands for *Python Package Index*. It is the official third-party software repository for Python. `pip` use it as the default source for packages and their dependencies. Packages on `PyPI` are typically uploaded by the author of the Python package. \n- [`conda-forge`](https://conda-forge.org/): Anaconda, Inc. provides several channels that host packages. `Conda-Forge` is one of the most important channels. Although it is a community project, it is now the recommended channel to get packages through `conda`. In `conda-forge`, package maintainers can be different than the original author of the package. \n\nUsually `PyPI` contains more packages than `conda-forge`, and the versions of packages get to `PyPI` faster. However, when using `conda` through `conda-forge`, more safty checks are done and `conda` will try its best to make the installed packages compatible. \n\nTo install from `conda-forge` using `conda`, you should add an argument `-c`:\n\n```{.bash}\nconda install -c conda-forge <pkg name>\n```\n:::\n\n\n\n\n\n## Virtual environments\nVirtual environments provide a project-specific version of installed packages. This both helps you to faithfully reproduce your environment as well as isolate the use of packages so that upgrading a package in one project doesn’t break other projects. In this section we are going to use `conda` to manage environments. The main reference is the official [document](https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html). We will just list the minimal working examples here. For more functions please read the official document. \n\n1. To create an environment:\n\n```{.bash}\nconda create --name <env name>\n```\n\n2. To activate an environment:\n\n```{.bash}\nconda activate <env name>\n```\n\nAfter you create a new environment and activate it, you may start to use the commands from the previous section to install packages.\n\n3. To deactivate an environment:\n\n```{.bash}\nconda deactivate\n```\n\n4. To remove an environemnt, both of the following commands work:\n\n```{.bash}\nconda remove --name <env name> --all\nconda env remove -n <env name>\n```\n\n5. To get all enviroments in the system:\n\n```{.bash}\nconda env list\nconda info --envs\n```\n\n\n\n::: {.callout-note collapse=\"true\"}\n## `pip` and `venv`\nUnlike `conda`, `pip` is only a package manager, and it doesn't provide any virtual environment functions. The default virtual environment tool for Python is `venv`. You may go to the official [document](https://docs.python.org/3/library/venv.html) for more infomation about `venv`.\n:::\n\n\n\n\n## Building identical environments\nSometimes people want to build identical environments. This is done by recording the versions of all packages in the current environment into a spec list file. When rebuilding Python will pull the spec list file out and install the packages of the speicific versions based on the list.\n\nIn the process, there are two steps. First generate the pacakge spec list file. Second create an environment based on the list. Note that the spec list file generated by different methods have different formats. Therefore you have to use the correct command to restore the environment.\n\n### Using `conda`\nTo produce a spec list, use the following command:\n\n```{.bash}\nconda list --explicit > spec-file.txt\n```\nTo install the packages, use the following command:\n\n```{.bash}\nconda create --name <env name> --file spec-file.txt\n```\n\nA typical `conda` environment file looks like the following example.\n\n```{.txt}\n# This file may be used to create an environment using:\n# $ conda create --name <env> --file <this file>\n# platform: win-64\n@EXPLICIT\nhttps://repo.anaconda.com/pkgs/main/win-64/conda-env-2.6.0-1.conda\nhttps://repo.anaconda.com/pkgs/r/win-64/_r-mutex-1.0.0-anacondar_1.conda\nhttps://repo.anaconda.com/pkgs/main/win-64/blas-1.0-mkl.conda\n```\n\n\n\n### Using `pip freeze`\nThe classic popular way is `pip freeze`. To produce a spec list, use the following command:\n\n```{.bash}\npip freeze > requirements.txt\n```\nTo install the packages, use the following command:\n\n```{.bash}\npip install -r requirements.txt\n```\n\nA typical `pip requirements.txt` file looks like the following example.\n\n```{.txt}\nanyio @ file:///C:/ci/anyio_1644481856696/work/dist\nargon2-cffi @ file:///opt/conda/conda-bld/argon2-cffi_1645000214183/work\nargon2-cffi-bindings @ file:///C:/ci/argon2-cffi-bindings_1644569876605/work\nasttokens==2.0.7\nattrs @ file:///C:/b/abs_09s3y775ra/croot/attrs_1668696195628/work\nBabel @ file:///tmp/build/80754af9/babel_1620871417480/work\nbackcall==0.2.0\n```\n\n\n::: {.callout-note}\nActually both ways are NOT satisfying. Therefore there are a lot of new tools coming out to deal with this task, like `pipreqs` and `poetry`. Here for simplicity we just briefly introduce the most basic ones.\n:::\n\n\n\n\n\n\n\n\n## `mamba` \n\n\n[`mamba`](https://github.com/mamba-org/mamba) is a reimplementation of the `conda` package manager in `C++`. It can be installed directly from `conda-forge`. \n\n```{.bash}\nconda install -c conda-forge mamba\n```\nAfter you install it in one of your environment, you may use it in all your environments.\n\n`mamba` can be treated as a drop-in replacement of `conda`. All commands we mentioned above can be rewritten by replacing `conda` with `mamba`. One of the reasons to use `mamba` over `conda` is that `mamba` runs so much faster than `conda`.\n\n","srcMarkdownNoYaml":"\n\n# Python Virtual Environment\n\n\n\n\n## Package management\nThere are two most popular package management tools for Python, `pip` and `conda`. \n\n- [`pip`](https://pip.pypa.io/) is the official package management tool for Python. \n- [`conda`](https://github.com/conda/conda) was originally developed by Anaconda Inc., and later became open-sourced. \n\nIn this course, we mainly focus on `conda` since it is designed towards Data Science.\n\n1. Install packages. You may specify the particular version number.\n\n```{.bash}\nconda install <pkg name>\nconda install <pkg name>=<version number>\n```\n\n2. List all installed packages, or list several specific installed packages:\n\n```{.bash}\nconda list\nconda list <pkg names>\n```\n\n3. Update packages.\n\n```{.bash}\nconda updata <pkg name>\n```\n\n4. Remove packages.\n\n```{.bash}\nconda remove <pkg name>\n```\n5. If the packages you want is in `PyPI` but not in `conda` channels, you may use `pip` to install that package.\n\n```{.bash}\npip install <pkg name>\n```\nNote that if the package is in both `conda` channels and `PyPI`, it is recommended not to mix `pip` and `conda`. If you start from `conda`, just stick to `conda`. Only use `pip` when you have to.\n\n\n\n::: {.callout-note collapse=\"true\"}\n## `PyPI` and `conda-forge`\n\nThe package managemers will download packages from online repository to install in your environment. By default, `pip` and `conda` use two different repositories. \n\n- [`PyPI`](https://pypi.org/): `PyPI` stands for *Python Package Index*. It is the official third-party software repository for Python. `pip` use it as the default source for packages and their dependencies. Packages on `PyPI` are typically uploaded by the author of the Python package. \n- [`conda-forge`](https://conda-forge.org/): Anaconda, Inc. provides several channels that host packages. `Conda-Forge` is one of the most important channels. Although it is a community project, it is now the recommended channel to get packages through `conda`. In `conda-forge`, package maintainers can be different than the original author of the package. \n\nUsually `PyPI` contains more packages than `conda-forge`, and the versions of packages get to `PyPI` faster. However, when using `conda` through `conda-forge`, more safty checks are done and `conda` will try its best to make the installed packages compatible. \n\nTo install from `conda-forge` using `conda`, you should add an argument `-c`:\n\n```{.bash}\nconda install -c conda-forge <pkg name>\n```\n:::\n\n\n\n\n\n## Virtual environments\nVirtual environments provide a project-specific version of installed packages. This both helps you to faithfully reproduce your environment as well as isolate the use of packages so that upgrading a package in one project doesn’t break other projects. In this section we are going to use `conda` to manage environments. The main reference is the official [document](https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html). We will just list the minimal working examples here. For more functions please read the official document. \n\n1. To create an environment:\n\n```{.bash}\nconda create --name <env name>\n```\n\n2. To activate an environment:\n\n```{.bash}\nconda activate <env name>\n```\n\nAfter you create a new environment and activate it, you may start to use the commands from the previous section to install packages.\n\n3. To deactivate an environment:\n\n```{.bash}\nconda deactivate\n```\n\n4. To remove an environemnt, both of the following commands work:\n\n```{.bash}\nconda remove --name <env name> --all\nconda env remove -n <env name>\n```\n\n5. To get all enviroments in the system:\n\n```{.bash}\nconda env list\nconda info --envs\n```\n\n\n\n::: {.callout-note collapse=\"true\"}\n## `pip` and `venv`\nUnlike `conda`, `pip` is only a package manager, and it doesn't provide any virtual environment functions. The default virtual environment tool for Python is `venv`. You may go to the official [document](https://docs.python.org/3/library/venv.html) for more infomation about `venv`.\n:::\n\n\n\n\n## Building identical environments\nSometimes people want to build identical environments. This is done by recording the versions of all packages in the current environment into a spec list file. When rebuilding Python will pull the spec list file out and install the packages of the speicific versions based on the list.\n\nIn the process, there are two steps. First generate the pacakge spec list file. Second create an environment based on the list. Note that the spec list file generated by different methods have different formats. Therefore you have to use the correct command to restore the environment.\n\n### Using `conda`\nTo produce a spec list, use the following command:\n\n```{.bash}\nconda list --explicit > spec-file.txt\n```\nTo install the packages, use the following command:\n\n```{.bash}\nconda create --name <env name> --file spec-file.txt\n```\n\nA typical `conda` environment file looks like the following example.\n\n```{.txt}\n# This file may be used to create an environment using:\n# $ conda create --name <env> --file <this file>\n# platform: win-64\n@EXPLICIT\nhttps://repo.anaconda.com/pkgs/main/win-64/conda-env-2.6.0-1.conda\nhttps://repo.anaconda.com/pkgs/r/win-64/_r-mutex-1.0.0-anacondar_1.conda\nhttps://repo.anaconda.com/pkgs/main/win-64/blas-1.0-mkl.conda\n```\n\n\n\n### Using `pip freeze`\nThe classic popular way is `pip freeze`. To produce a spec list, use the following command:\n\n```{.bash}\npip freeze > requirements.txt\n```\nTo install the packages, use the following command:\n\n```{.bash}\npip install -r requirements.txt\n```\n\nA typical `pip requirements.txt` file looks like the following example.\n\n```{.txt}\nanyio @ file:///C:/ci/anyio_1644481856696/work/dist\nargon2-cffi @ file:///opt/conda/conda-bld/argon2-cffi_1645000214183/work\nargon2-cffi-bindings @ file:///C:/ci/argon2-cffi-bindings_1644569876605/work\nasttokens==2.0.7\nattrs @ file:///C:/b/abs_09s3y775ra/croot/attrs_1668696195628/work\nBabel @ file:///tmp/build/80754af9/babel_1620871417480/work\nbackcall==0.2.0\n```\n\n\n::: {.callout-note}\nActually both ways are NOT satisfying. Therefore there are a lot of new tools coming out to deal with this task, like `pipreqs` and `poetry`. Here for simplicity we just briefly introduce the most basic ones.\n:::\n\n\n\n\n\n\n\n\n## `mamba` \n\n\n[`mamba`](https://github.com/mamba-org/mamba) is a reimplementation of the `conda` package manager in `C++`. It can be installed directly from `conda-forge`. \n\n```{.bash}\nconda install -c conda-forge mamba\n```\nAfter you install it in one of your environment, you may use it in all your environments.\n\n`mamba` can be treated as a drop-in replacement of `conda`. All commands we mentioned above can be rewritten by replacing `conda` with `mamba`. One of the reasons to use `mamba` over `conda` is that `mamba` runs so much faster than `conda`.\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"number-sections":true,"top-level-division":"part","toc-depth":3,"highlight-style":"atom-one","output-file":"virtenv.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.530","number-depth":4,"bibliography":["../../book.bib"],"csl":"../../ims.csl","crossref":{"labels":"arabic","subref-labels":"roman i"},"knitr":{"opts_chunk":{"comment":"#>","collapse":true}},"jupyter":"ds24","theme":"lumen","code-block-bg":true,"code-block-border-left":false,"page-layout":"article"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}